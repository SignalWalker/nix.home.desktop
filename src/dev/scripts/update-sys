#! /usr/bin/env zsh

set -e

echo "Updating:\n\thomelib..." && nix flake update --commit-lock-file ~/projects/nix/home/lib && git push \
	&& echo "\thomebase..." && nix flake update --commit-lock-file ~/projects/nix/home/base && git push \
	&& echo "\thomedev..." && nix flake update --commit-lock-file ~/projects/nix/home/dev && git push \
	&& echo "\thomedesk..." && nix flake update --commit-lock-file ~/projects/nix/home/desktop && git push \
	&& echo "\thomemedia..." && nix flake update --commit-lock-file ~/projects/nix/home/media && git push \
	&& echo "\tsysbase..." && nix flake update --commit-lock-file ~/projects/nix/sys/base && git push \
	&& echo "\tsyshome..." && nix flake update --commit-lock-file ~/projects/nix/sys/home && git push \
	&& echo "\tsysdesk..." && nix flake update --commit-lock-file ~/projects/nix/sys/desktop && git push

# nix build --no-link -L --show-trace --impure ~/projects/nix/sys/desktop ${argv} \
# 	&& nix profile remove 0 \
# 	&& nix run --impure ~/projects/nix/sys/desktop#activate-default ${argv}
